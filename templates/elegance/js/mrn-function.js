function ajax_loader(a,b,c){bootbox.process({message:"Working"}),$("#content").empty(),$("#content").html(""),$.ajax({cache:!1,url:"?_tsk="+a+"&ajax=1",type:"POST",data:b+"&cor=1",dataType:"html",success:function(a){bootbox.hideAll();var b=a.split("#");if(3==b[0])ajax_loadmessage(b[1],"nok",5e3),$("#content").empty(),"undefined"!=typeof c?ajax_loader(c,""):window.setTimeout(function(){window.location="./"},5e3);else{var d=a.split("#||#");$("#treeapp").html(d[0]);var e=d[1].split("#");3==e[0]?(ajax_loadmessage(e[1],"nok",5e3),$("#content").empty(),"undefined"!=typeof c?ajax_loader(c,""):window.setTimeout(function(){window.location="./"},5e3)):$("#content").html(d[1])}},timeout:3e4,error:function(){ajax_loadmessage("Délai non attendue","nok",5e3)}})}function ajax_bbox_loader(a,b,c,d){$.ajax({cache:!1,url:"?_tsk="+a+"&ajax=1",type:"POST",data:b,dataType:"html",success:function(b){var e=b.split("#");3==e[0]?ajax_loadmessage(e[1],"nok",5e3):(bootbox.dialog({message:b,title:c,size:void 0!==d?d:"",buttons:{click:{label:"Click ME!",className:"btn-sm btn-primary",callback:function(b){return $("#"+a).submit(),!1}}}}),$(".bootbox-body").ace_scroll({size:300}))},timeout:3e4,error:function(){ajax_loadmessage("Délai non attendue","nok",5e3)}})}function bb_add_pic(a,b,c){$.ajax({cache:!1,url:"?_tsk="+a+"&ajax=1",type:"POST",data:"",dataType:"html",success:function(a){var d=a.split("#");3==d[0]?ajax_loadmessage(d[1],"nok",5e3):bootbox.dialog({message:a,title:b,size:void 0!==c?c:"",buttons:{cancel:{label:"Annuler",className:"btn-sm"},click:{label:"Enregistrer",className:"btn-sm btn-primary",callback:function(a){return $pic_link=$("#photo-id").val(),$pic_titl=$("#pic_titl").val(),$pic_link&&$pic_titl?($bloc_pic='<li><a href="#" class="show_pic" rel="'+$pic_link+'"><img width="150" height="150" alt="150x150" src="'+$pic_link+'" /><div class="text"><div class="inner"><input name="photo_id[]" value="'+$pic_link+'" type="hidden"><input  name="photo_titl[]" value="'+$pic_titl+'" type="hidden">'+$pic_titl+'</div></div></a><div class="tools tools-bottom"><a href="#"><i class="ace-icon fa fa-times red"></i></a></div></li>',$(".ace-thumbnails").append($bloc_pic),!0):(ajax_loadmessage("Il faut remplire les champs","nok",5e3),!1)}}}})},timeout:3e4,error:function(){ajax_loadmessage("Délai non attendue","nok",5e3)}})}function do_ajax(a,b,c){bootbox.process({message:"Working"}),$.ajax({url:"?_tsk="+a+"&ajax=1",type:"POST",data:b,dataType:"html",success:function(a,b){var d=a.split("#");if(1==d[0]){ajax_loadmessage(d[1],"ok",5e4);var e=$("#"+c).DataTable();e.row(".selected").remove().draw(!1),bootbox.hideAll()}else ajax_loadmessage(d[1],"nok",5e4),bootbox.hideAll()},timeout:3e4,error:function(){ajax_loadmessage("Délai non attendue","nok",5e3)}})}function exec_ajax(a,b,c,d,e){var f="undefined"!=typeof d?"Veuillez confirmer !":d;return 1==c?bootbox.confirm(f,function(c){c&&do_ajax(a,b,e)}):do_ajax(a,b,e),!0}function ajax_loadmessage(a,b,c){return c="undefined"!=typeof c?c:5e3,$laclass="ok"==b?"gritter-success":"gritter-error",$titre="ok"==b?"Opération  réussie":"Erreur Opération",$.gritter.add({title:$titre,text:a,class_name:$laclass+"  gritter-center gritter-light",time:c}),!1}function fliupld(a,b,c,d,e){var f=$("#"+a),g=!1,h=$allowMime=$value=$value_input=null;void 0===c?(h=null,$allowMime=null):"image"==c?(h=["jpeg","jpg","png","gif"],$allowMime=["image/jpg","image/jpeg","image/png","image/gif"]):"pdf"==c?(h=["pdf"],$allowMime=["application/pdf"]):"doc"==c&&(h=["pdf","doc","docx","xls","xlsx","txt"],$allowMime=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/plain"]),$value=void 0===d?"":d,""!=$value&&1==e&&($value_input=f.attr("value")),f.ace_file_input({droppable:!0,value_field:$value,value_input:$value_input,thumbnail:"large",maxSize:b,allowExt:h,allowMime:$allowMime,type_file:c,is_edit:e,before_remove:function(){return!g},preview_error:function(a,b){}}),f.on("file.error.ace",function(a,c){return c.error_count.ext||c.error_count.mime?void ajax_loadmessage("Le type de fichier est non autorisé! <br><b>"+h,"nok"):c.error_count.size?void ajax_loadmessage("La taille de fichier ne doit pas dépasser "+parseInt(b/781)+" Kb !","nok"):void f.ace_file_input("reset_input")});var i=null;f.on("change",function(b){b.preventDefault();var c=f.data("ace_input_files");if(!c||0==c.length)return!1;var d;if("FormData"in window){formData_object=new FormData;var e=f.attr("name"),c=$(this).data("ace_input_files");if(c&&c.length>0)for(var h=0;h<c.length;h++)formData_object.append(e,c[h]),formData_object.append("fileID",a),formData_object.append("upld",1);g=!0,f.ace_file_input("loading",!0),d=$.ajax({url:"./?_tsk=upload&ajax=1",type:"POST",processData:!1,contentType:!1,dataType:"html",data:formData_object})}d.done(function(b){var c=b.split("#");1==c[0]?(f.ace_file_input("disable",!0),$("#"+a+"-id").attr("value",c[1])):(ajax_loadmessage(c[1],"nok"),f.ace_file_input("reset_input",!0))}).fail(function(a){ajax_loadmessage("Problème Envoi","nok")}).always(function(){i&&clearTimeout(i),i=null,g=!1,f.ace_file_input("loading",!1)}),d.promise()})}function load_onselect(a){if(""!=$(a).val()){var b=$(a).closest(".form-group");$.ajax({url:"./?_tsk=loadenselect&ajax=1&tb=1",type:"POST",data:"tab=1&id="+$(a).val(),dataType:"html",success:function(a){$(a).appendTo(b)}})}else $("#"+zone).empty()}function call_colorBox(a){$.colorbox({iframe:!0,width:"80%",height:"90%",href:"?_tsk=shopdf&ajax=1&doc="+a})}function append_drop_menu(a,b,c){$(c+" ul").remove(),$.ajax({type:"POST",url:"?_tsk="+a+"&ajax=1",data:"id="+b+"&act=1",timeout:3e3,success:function(a){var b=a.split("#");3==b[0]?(ajax_loadmessage(b[1],"nok",5e3),$("#content").empty(),"undefined"!=typeof $redirect?ajax_loader($redirect,""):window.setTimeout(function(){window.location="./"},5e3)):$(c).append(a)},error:function(){ajax_loadmessage("Action indisponible","nok",3e3)}})}$("html").click(function(){$("#gritter-notice-wrapper").length&&($("#gritter-notice-wrapper").remove(),$(".modal-body".length)||bootbox.hideAll())}),$("body").on("click",".this_url",function(){$("#gritter-notice-wrapper").remove();var a=$(this).attr("rel"),b=""!=$(this).attr("data")?$(this).attr("data"):"",c=""!=$(this).attr("redi")?$(this).attr("redi"):"";ajax_loader(a,b,c),1==$(this).attr("left_menu")&&($(".active").removeClass("active"),$(this).parent("li").addClass("active"))}),$("body").on("click",".this_exec",function(){$("#gritter-notice-wrapper").remove();var a=$(this).attr("rel"),b=""!=$(this).attr("data")?$(this).attr("data"):"",c=$(this).closest("table").attr("id");exec_ajax(a,b,$confirm=1,"",c)}),$(function(){$("body").on("keypress keyup",".is-number",function(a){if(8!=a.which&&0!=a.which&&(a.which<48||a.which>57))return!1}),$("body").bind("DOMNodeInserted",function(){})}),$(document).ready(function(){$("body").on("click",".iframe_pdf",function(){$.ajax({type:"POST",url:"./?_tsk=shopdf&ajax=1",data:"doc="+$(this).attr("rel"),timeout:3e3,success:function(a){var b=a.split("#");if(1==b[0]){var c=b[1].split(".");return"pdf"==c[2]?$.colorbox({iframe:!0,width:"80%",height:"90%",href:b[1]}):$.colorbox({image:!0,href:b[1]}),!0}return ajax_loadmessage(b[1],"nok"),!1},error:function(){return ajax_loadmessage("Affichage Impossible #AJAX","nok",3e3),!1}})}),$("body").on("click",".show_pic",function(){var a=$(this).attr("rel");$(".show_pic").colorbox({image:!0,href:a})}),$("body").on("click",".this_map",function(){var a=$(this).attr("rel");$("body").fullScreen(!0),setTimeout(function(){$.colorbox({iframe:!0,map:!0,width:"100%",height:"100%",href:"./map/?"+a})},500)}),$("body").on("click",".this_modal",function(){var a=$(this).attr("rel"),b=$(this).attr("data_titre"),c=$(this).attr("data");ajax_bbox_loader(a,c,b,"large")})}),$(document).ready(function(){"undefined"!=typeof firsttime&&1==firsttime&&(bootbox.process({message:"Working"}),setTimeout(function(){ajax_loader("dbd")},2e3),2==firsttime)});